<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EasyHypergraph &mdash; EasyGraph 1.4.1</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="EGGPU" href="eggpu.html" />
    <link rel="prev" title="Examples of Graph Analysis" href="example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> EasyGraph
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples of Graph Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">EasyHypergraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="eggpu.html">EGGPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributorGuide.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="sourcecode.html">Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="honors.html">Honors</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developer Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EasyGraph</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>EasyHypergraph</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/hypergraph.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="easyhypergraph">
<h1>EasyHypergraph<a class="headerlink" href="#easyhypergraph" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>We present a comprehensive, computation-effective, and storage-saving hypergraph library designed not only for in-depth hypergraph analysis but also for the growing field of hypergraph learning. The library, called EasyHypergraph, allows users from multiple disciplines to input hypergraph data, efficiently perform hypergraph analysis or hypergraph learning tasks on large-scale datasets by utilizing computational workflow, and gain insights from higher-order structures. EasyHypergraph’s broad capabilities and computational efficiency empower researchers and practitioners from various fields to effectively harness the potential of higher-order networks, sparking innovative solutions for practical problems.
Its architecture is shown as follows:</p>
<img alt="_images/function_dynamic.png" src="_images/function_dynamic.png" />
</section>
<section id="correlation-with-easygraph">
<h2>Correlation with EasyGraph<a class="headerlink" href="#correlation-with-easygraph" title="Permalink to this heading"></a></h2>
<p>EasyHypergraph bridges the gap between EasyGraph and higher-order relationships. EasyHypergraph is developed as an integrated library within the EasyGraph framework, maintaining full compatibility with its core architecture.
Specifically, one hypergraph modeled by EasyHypergraph can be projected into a simple graph in EasyGraph by hypergraph projection algorithms. Then, users can utilize the algorithms associated with simple graphs in EasyGraph for further exploration without relying on external libraries.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>Please refer to the installation of <a class="reference external" href="https://easy-graph.github.io/docs/install.html">EasyGraph</a></p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>Hypergraph class definition, properties and projection algorithms</dt><dd><ul>
<li><p><a class="reference internal" href="reference/easygraph.classes.hypergraph.html#module-easygraph-classes-hypergraph"><span class="std std-ref">easygraph.classes.hypergraph module</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Hypergraph datasets module</dt><dd><ul>
<li><p><a class="reference internal" href="reference/easygraph.datasets.hypergraph.html#module-easygraph-datasets-hypergraph"><span class="std std-ref">easygraph.datasets.hypergraph package</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Hypergraph analysis module</dt><dd><ul>
<li><p><a class="reference internal" href="reference/easygraph.functions.hypergraph.assortativity.html#module-easygraph-functions-hypergraph-assortativity"><span class="std std-ref">hypergraph assortativity</span></a></p></li>
<li><p><a class="reference internal" href="reference/easygraph.functions.hypergraph.html#module-easygraph-functions-hypergraph"><span class="std std-ref">easygraph.functions.hypergraph package</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Hypergraph learning module</dt><dd><ul>
<li><p><a class="reference internal" href="reference/easygraph.model.hypergraphs.html#module-easygraph-model-hypergraphs"><span class="std std-ref">easygraph.model.hypergraphs package</span></a></p></li>
<li><p><a class="reference internal" href="reference/easygraph.nn.html#module-easygraph-nn"><span class="std std-ref">easygraph.nn package</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Hypergraph visualization module</dt><dd><ul>
<li><p><a class="reference internal" href="reference/easygraph.functions.drawing.html#module-easygraph-functions-drawing"><span class="std std-ref">easygraph.functions.drawing package</span></a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>We provide a brief introduction to the fundamental properties, basic operations, and node classification tasks on hypergraph using <strong>EasyGraph</strong>.</p>
<section id="basic-properties-and-operations-of-hypergraph">
<h3>Basic Properties and Operations of Hypergraph<a class="headerlink" href="#basic-properties-and-operations-of-hypergraph" title="Permalink to this heading"></a></h3>
<p>Please refer to the related source code <a class="reference external" href="https://github.com/easy-graph/Easy-Graph/blob/pybind11/easygraph/classes/hypergraph.py">here</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The nodes in our eg.Hypergraph are numbered from 0 to n - 1 (where n is the number of nodes). Each hyperedge in the hypergraph is represented as an unordered set of vertices. Therefore, hyperedges such as <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>, <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">2,</span> <span class="pre">1)</span></code>, and <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">1,</span> <span class="pre">0)</span></code> are considered identical.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hg</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">Hypergraph</span><span class="p">(</span><span class="n">num_v</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">e_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">merge_op</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sparse format:&quot;</span><span class="p">,</span><span class="n">hg</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Sparse format:</span>
<span class="sd">  (0, 0)        1</span>
<span class="sd">  (0, 2)        1</span>
<span class="sd">  (1, 0)        1</span>
<span class="sd">  (2, 0)        1</span>
<span class="sd">  (2, 1)        1</span>
<span class="sd">  (3, 1)        1</span>
<span class="sd">  (4, 2)        1</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dense format:&quot;</span><span class="p">,</span><span class="n">hg</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Dense format:</span>
<span class="sd">[[1 0 1]</span>
<span class="sd"> [1 0 0]</span>
<span class="sd"> [1 1 0]</span>
<span class="sd"> [0 1 0]</span>
<span class="sd"> [0 0 1]]</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hg.e:&quot;</span><span class="p">,</span><span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="c1"># ([(0, 1, 2), (2, 3), (0, 4)], [1.0, 2.0, 1.0], [{}, {}, {}])</span>
<span class="n">e_line_width</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">hg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">v_label</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">v_color</span><span class="o">=</span><span class="s1">&#39;#e6928f&#39;</span><span class="p">,</span> <span class="n">e_color</span><span class="o">=</span><span class="s1">&#39;#4e9595&#39;</span><span class="p">,</span> <span class="n">e_line_width</span><span class="o">=</span><span class="n">e_line_width</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/hypergraph_example1.png" src="_images/hypergraph_example1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add hyperedges and you can find the weight of the last hyperedge is 1.0 and 2.0, if you set the merge_op to mean and sum, respectively.</span>
<span class="n">hg</span><span class="o">.</span><span class="n">add_hyperedges</span><span class="p">(</span><span class="n">e_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">merge_op</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hg.e:&quot;</span><span class="p">,</span> <span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="c1"># ([(0, 1, 2), (2, 3), (0, 4), (2, 4)], [1.0, 2.0, 1.0, 1.0], [{}, {}, {}, {}])</span>
<span class="n">hg</span><span class="o">.</span><span class="n">add_hyperedges</span><span class="p">(</span><span class="n">e_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">merge_op</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hg.e:&quot;</span><span class="p">,</span> <span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="c1"># ([(0, 1, 2), (2, 3), (0, 4), (2, 4)], [1.0, 2.0, 1.0, 1.0], [{}, {}, {}, {}])</span>
<span class="n">hg</span><span class="o">.</span><span class="n">remove_hyperedges</span><span class="p">(</span><span class="n">e_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hg.e:&quot;</span><span class="p">,</span> <span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="c1"># ([(0, 1, 2), (0, 4), (2, 4)], [1.0, 1.0, 2.0], [{}, {}, {}])</span>
</pre></div>
</div>
<img alt="_images/hypergraph_example2.png" src="_images/hypergraph_example2.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the added hyperedges have duplicate hyperedges, those duplicate hyperedges will be automatically merged with specified merge_op.
If merge_op = ‘sum’, the weight is the sum of duplicate hyperedges weights.
If merge_op = ‘mean’, the weight is the average sum of duplicate hyperedges weights.</p>
</div>
<p>Create a hypergraph based on the k-nearest neighbors of the features.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0658</span><span class="p">,</span> <span class="mf">0.3191</span><span class="p">,</span> <span class="mf">0.0204</span><span class="p">,</span> <span class="mf">0.6955</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.1144</span><span class="p">,</span> <span class="mf">0.7131</span><span class="p">,</span> <span class="mf">0.3643</span><span class="p">,</span> <span class="mf">0.4707</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.2250</span><span class="p">,</span> <span class="mf">0.0620</span><span class="p">,</span> <span class="mf">0.0379</span><span class="p">,</span> <span class="mf">0.2848</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.0619</span><span class="p">,</span> <span class="mf">0.4898</span><span class="p">,</span> <span class="mf">0.9368</span><span class="p">,</span> <span class="mf">0.7433</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.5380</span><span class="p">,</span> <span class="mf">0.3119</span><span class="p">,</span> <span class="mf">0.6462</span><span class="p">,</span> <span class="mf">0.4311</span><span class="p">]])</span>
<span class="n">hg</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">Hypergraph</span><span class="o">.</span><span class="n">from_feature_kNN</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;hg: </span><span class="si">{</span><span class="n">hg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;hg.e: </span><span class="si">{</span><span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">hg: Hypergraph(num_vertex=5, num_hyperedge=4)</span>
<span class="sd">hg.e: ([(0, 1, 2), (0, 1, 4), (0, 2, 4), (1, 3, 4)], [1.0, 1.0, 1.0, 1.0], [{}, {}, {}, {}])</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H:&quot;</span><span class="p">,</span><span class="n">hg</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">to_dense</span><span class="p">())</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">H: [[1 1 1 0]</span>
<span class="sd">     [1 1 0 1]</span>
<span class="sd">     [1 0 1 0]</span>
<span class="sd">     [0 0 0 1]</span>
<span class="sd">     [0 1 1 1]]</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">hg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">v_label</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">v_color</span><span class="o">=</span><span class="s1">&#39;#e6928f&#39;</span><span class="p">,</span> <span class="n">e_color</span><span class="o">=</span><span class="s1">&#39;#4e9595&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<img alt="_images/hypergraph_example3.png" src="_images/hypergraph_example3.png" />
<p>Construct a hypergraph from a graph:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="n">hg</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">Hypergraph</span><span class="o">.</span><span class="n">from_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;hg.e:</span><span class="si">{</span><span class="n">hg</span><span class="o">.</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># ([(0, 1), (1, 2), (1, 4), (2, 3)], [1.0, 1.0, 1.0, 1.0], [{}, {}, {}, {}])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H:</span><span class="si">{</span><span class="n">hg</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">to_dense</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">H:  [[1 0 0 0]</span>
<span class="sd">     [1 1 1 0]</span>
<span class="sd">     [0 1 0 1]</span>
<span class="sd">     [0 0 0 1]</span>
<span class="sd">     [0 0 1 0]]</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
</section>
<section id="train-a-hypergraph-neural-network-hgnn-model-on-the-trivago-clicks-dataset">
<h3>Train a Hypergraph Neural Network (HGNN) model on the trivago-clicks dataset:<a class="headerlink" href="#train-a-hypergraph-neural-network-hgnn-model-on-the-trivago-clicks-dataset" title="Permalink to this heading"></a></h3>
<p>The related source code can be found in the following repositories: <a class="reference external" href="https://github.com/easy-graph/Easy-Graph/tree/pybind11/easygraph/model">hypergraph model</a> and <a class="reference external" href="https://github.com/easy-graph/Easy-Graph/tree/pybind11/easygraph/datasets/hypergraph">hypergraph datasets</a>.</p>
<p>We demonstrate a specific node classification task on the trivago-clicks dataset using a Hypergraph Neural Network (HGNN).</p>
<p><strong>Model:</strong></p>
<p>Hypergraph Neural Networks (HGNN)</p>
<p>(Feng, Y., You, H., Zhang, Z., Ji, R., &amp; Gao, Y. (2019). Hypergraph Neural Networks. Proceedings of the AAAI Conference on Artificial Intelligence, 33(01), 3558-3565. ).</p>
<p><strong>Dataset:</strong></p>
<p>trivago-clicks (eg.trivago_clicks):
Sets of hotels clicked on in a Web browsing session, where labels are the countries of the accommodation.</p>
<p><strong>Import Libraries:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">easygraph</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">eg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
<p><strong>Dataset preparation and model definition:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">preprocess</span><span class="p">():</span>
<span class="sd">&quot;&quot;&quot;Preprocess for HGNN model training.</span>

<span class="sd">    Preprocess dataset and model</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: dataset and model</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># There is no default feature vector for this dataset. Users can generate their own features.</span>
<span class="c1"># Here we use random initialization to generate 100-dimensional node feature vectors</span>

<span class="n">trivago_clicks</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">trivago_clicks</span><span class="p">()</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="n">trivago_clicks</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
<span class="n">hyperedges</span> <span class="o">=</span> <span class="n">trivago_clicks</span><span class="p">[</span><span class="s2">&quot;edge_list&quot;</span><span class="p">]</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="n">trivago_clicks</span><span class="p">[</span><span class="s2">&quot;num_classes&quot;</span><span class="p">]</span>
<span class="n">num_vertices</span> <span class="o">=</span> <span class="n">trivago_clicks</span><span class="p">[</span><span class="s2">&quot;num_vertices&quot;</span><span class="p">]</span>
<span class="n">input_feature_dim</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">hidden_dim</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">num_features</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">node_features</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)):</span>
    <span class="n">node_features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Since there is no default split for this dataset, here we split the test set, validation set, and test set in a 50:25:25 fashion</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">train_nodes</span><span class="p">,</span> <span class="n">test_nodes</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_vertices</span><span class="p">)),</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">train_nodes</span><span class="p">,</span> <span class="n">val_nodes</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_nodes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">train_mask</span> <span class="o">=</span> <span class="n">train_nodes</span>
<span class="n">val_mask</span> <span class="o">=</span> <span class="n">val_nodes</span>
<span class="n">test_mask</span> <span class="o">=</span> <span class="n">test_nodes</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">node_features</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node_labels</span><span class="p">))])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node_labels</span><span class="p">))])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">Hypergraph</span><span class="p">(</span><span class="n">num_v</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">node_labels</span><span class="p">),</span> <span class="n">e_list</span><span class="o">=</span><span class="n">hyperedges</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_mask</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;val_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_mask</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_mask</span>
<span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;num_classes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_classes</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">eg</span><span class="o">.</span><span class="n">HGNN</span><span class="p">(</span><span class="n">in_channels</span> <span class="o">=</span> <span class="n">input_feature_dim</span><span class="p">,</span> <span class="n">hid_channels</span> <span class="o">=</span> <span class="n">hidden_dim</span><span class="p">,</span>
                     <span class="n">num_classes</span> <span class="o">=</span> <span class="n">num_classes</span><span class="p">)</span>

<span class="k">return</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">model</span>
</pre></div>
</div>
<p><strong>Train, valid, test:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
    <span class="n">criterion</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,):</span>

    <span class="n">features</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">train_mask</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;train_mask&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">train_mask</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">train_mask</span><span class="p">])</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span>

<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">valid</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">val_mask</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;val_mask&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">val_mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">labels</span><span class="p">[</span><span class="n">val_mask</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acc</span>

<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">val_mask</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;test_mask&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">val_mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">labels</span><span class="p">[</span><span class="n">val_mask</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acc</span>
</pre></div>
</div>
<p><strong>Loss visualization:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">draw_loss_curve</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span> <span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;loss_pic.png&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loss1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">loss1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EG Training loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training Loss Comparison&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epochs&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Main:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">dataset</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">()</span>
    <span class="n">loss_lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">epoch</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">)</span>
        <span class="n">loss_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">val_acc</span> <span class="o">=</span> <span class="n">valid</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, valid accuracy : </span><span class="si">{</span><span class="n">val_acc</span><span class="si">}</span><span class="s2">, loss : </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training finish!&quot;</span><span class="p">)</span>
    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test accuracy:&quot;</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
    <span class="n">draw_loss_curve</span><span class="p">(</span><span class="n">loss_lst</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">epoch</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.2997239226983555</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.3755440711975098</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.30524546873124475</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.3317201137542725</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.30806625855239467</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.2897789478302</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.3118473172488297</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.248279571533203</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.31736886328171887</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.2077314853668213</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.32355059416636656</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">2.169461727142334</span>
<span class="o">......</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">495</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.44616492617933023</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">1.5331683158874512</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">496</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.445744808546393</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">1.5331355333328247</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">497</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.44616492617933023</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">1.533029317855835</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">498</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.4456247749369824</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">1.5328493118286133</span>
<span class="n">epoch</span><span class="p">:</span> <span class="mi">499</span><span class="p">,</span> <span class="n">valid</span> <span class="n">accuracy</span> <span class="p">:</span> <span class="mf">0.4461049093746249</span><span class="p">,</span> <span class="n">loss</span> <span class="p">:</span> <span class="mf">1.5326640605926514</span>

<span class="n">Training</span> <span class="n">finish</span>
<span class="n">test</span> <span class="n">accuracy</span><span class="p">:</span> <span class="mf">0.4464550979068197</span>
</pre></div>
</div>
<img alt="_images/loss_pic.png" src="_images/loss_pic.png" />
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example.html" class="btn btn-neutral float-left" title="Examples of Graph Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="eggpu.html" class="btn btn-neutral float-right" title="EGGPU" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, DataNET Group, Fudan University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>